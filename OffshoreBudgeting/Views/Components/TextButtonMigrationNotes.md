# Text Button Migration Notes

## Shared Environment & QA Logging Dependencies

- `RootHeaderIconActionButton` pulls `platformCapabilities` from the environment and the shared `ThemeManager` object to align sizing with OS 26 glass affordances and tint controls with the active theme. 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L772-L819】
- The icon content it hosts relies on `RootHeaderControlIcon`, which sets an SF Symbol font at 18 pt regular weight and resolves foreground color through `ThemeManager` to swap between `.primary` and the selected theme tint. 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L62-L95】
- `GlassCTAButton` also reads `platformCapabilities`, `ThemeManager`, and the view `colorScheme`, using them to toggle between `.glass` and `TranslucentButtonStyle`, derive tint colors, and choose a contrasting label foreground. It emits QA visibility via `PlatformCapabilities.qaLogLiquidGlassDecision(component:path:)` to track whether the glass or legacy treatment rendered. 【F:OffshoreBudgeting/Views/Components/GlassCTAButton.swift†L7-L111】

## Design Tokens Reused by Icon & CTA Buttons

| Component | Font | Horizontal Padding | Vertical Padding | Tint / Foreground Rules |
|-----------|------|--------------------|------------------|-------------------------|
| Root header icons | `.system(size: 18, weight: .regular)` on SF Symbols via `RootHeaderControlIcon`; glass buttons clamp frame to `RootHeaderActionMetrics.dimension` (>= 44 pt). 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L62-L99】【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L772-L819】 | Encapsulated by `RootHeaderGlassMetrics.horizontalPadding = DS.Spacing.s * 0.5` when rendered in capsules. 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L3-L48】【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L566-L617】 | `RootHeaderGlassMetrics.verticalPadding = DS.Spacing.xs * 0.75` within capsule wrappers. 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L3-L48】【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L566-L617】 | Uses `.glass` style with `.buttonBorderShape(.circle)` and `.tint(themeManager.selectedTheme.resolvedTint)` on modern OS; legacy path wraps `RootHeaderGlassControl` with the same tint sourced from the theme. 【F:OffshoreBudgeting/Views/Components/RootHeaderActions.swift†L792-L819】 |
| GlassCTAButton | `.system(size: 17, weight: .semibold, design: .rounded)` applied inside `buttonLabel()`. 【F:OffshoreBudgeting/Views/Components/GlassCTAButton.swift†L76-L83】 | `.padding(.horizontal, DS.Spacing.xl)` when constructing the label. 【F:OffshoreBudgeting/Views/Components/GlassCTAButton.swift†L76-L83】 | `.padding(.vertical, DS.Spacing.m)`. 【F:OffshoreBudgeting/Views/Components/GlassCTAButton.swift†L76-L83】 | `.tint(themeManager.selectedTheme.glassPalette.accent)` for glass; `.tint(themeManager.selectedTheme.resolvedTint)` via fallback `TranslucentButtonStyle`; label text renders black in light mode and `.primary` otherwise. QA logging records glass vs. legacy presentation path. 【F:OffshoreBudgeting/Views/Components/GlassCTAButton.swift†L57-L111】 |

These metrics should seed the planned text-button component so icon, CTA, and future text affordances stay visually aligned.

## Existing Text-Only Button Call Sites

| Location | UI Context | Labels & Styling Notes |
|----------|------------|------------------------|
| `ManageBudgetCardsSheet` toolbar | Navigation toolbar cancel action uses `Button("Done")` without explicit tint; dismissal ties into Core Data save completion. 【F:OffshoreBudgeting/Views/ManageBudgetCardsSheet.swift†L36-L39】 |
| `ManageBudgetPresetsSheet` toolbar | `Button("Done")` presented as the cancellation action; relies on sheet dismissal helper. 【F:OffshoreBudgeting/Views/ManageBudgetPresetsSheet.swift†L45-L50】 |
| `PresetBudgetAssignmentSheet` toolbar | iOS path exposes `Button("Cancel")` and a `.font(.headline)` `Button("Done")`; macOS path mirrors placements using `.cancellationAction` / `.confirmationAction`. No explicit tint. 【F:OffshoreBudgeting/Views/PresetBudgetAssignmentSheet.swift†L55-L84】 |
| `CustomRecurrenceEditorView` toolbar | Both navigation container variants supply `Button("Cancel")` and `.font(.headline)` `Button("Save")`. 【F:OffshoreBudgeting/Views/CustomRecurrenceEditorView.swift†L100-L137】 |
| `EditSheetScaffold` toolbar | Standardized sheet chrome sets cancel/save buttons with `.tint(themeManager.selectedTheme.resolvedTint)` and disables save via `.disabled`. Labels are dynamic strings. 【F:OffshoreBudgeting/Views/EditSheetScaffold.swift†L83-L105】 |
| `CardDetailView` toolbar | Leading `Button("Done")` adds `keyboardShortcut(.escape)`; trailing group swaps between a plain text `Button("Cancel")` during search and icon buttons otherwise. Menu exposes additional text-only entries for adding expenses. 【F:OffshoreBudgeting/Views/CardDetailView.swift†L404-L445】 |
| `HomeView` toolbar menus | `Menu` controls surface text actions: “Add Planned Expense,” “Add Variable Expense,” and `Label`-based entries for budget management. These inherit `.menuStyle(.button)` tinting when glass is available. 【F:OffshoreBudgeting/Views/HomeView.swift†L266-L340】 |
| `HomeView` budget summary sheet triggers | Separate `Menu` for active budgets reuses the same text labels while dispatching scoped events (IDs must remain intact for routing). 【F:OffshoreBudgeting/Views/HomeView.swift†L293-L309】 |
| `AddPlannedExpenseView` scope dialog | Confirmation dialog offers “Only this expense,” “Past instances,” “Future instances,” “All instances,” and a cancel role. Each path triggers different persistence scope—labels must stay mapped to their respective enum cases. 【F:OffshoreBudgeting/Views/AddPlannedExpenseView.swift†L269-L294】 |
| `AddIncomeFormView` scope dialog | Similar multi-scope dialog with longer labels; keep role-less destructive actions aligned with their save scopes plus a cancel role. 【F:OffshoreBudgeting/Views/AddIncomeFormView.swift†L84-L95】 |
| `IncomeView` calendar header | HStack of text buttons (“<<”, “<”, “Today”, “>”, “>>”) styled via `.incomeCalendarGlassButtonStyle(role:)` to mix icon-sized and label-sized treatments. Accessibility labels differentiate navigation targets. 【F:OffshoreBudgeting/Views/IncomeView.swift†L456-L485】 |
| `IncomeView` delete flows | Alert and confirmation dialog expose text buttons with destructive roles and scoped deletion handlers (“This Instance Only,” “This and Future Instances,” etc.). 【F:OffshoreBudgeting/Views/IncomeView.swift†L607-L629】 |
| `BudgetDetailsView` alerts | Planned and unplanned expense alerts include “Delete” (destructive) and “Cancel” actions tied to row state. 【F:OffshoreBudgeting/Views/BudgetDetailsView.swift†L971-L979】【F:OffshoreBudgeting/Views/BudgetDetailsView.swift†L1335-L1344】 |
| `BudgetDetailsView` CTA buttons | Inline add button composes text within a `.glass` style on modern OS and `.plain` fallback otherwise; this will be a key adopter to maintain CTA parity. 【F:OffshoreBudgeting/Views/BudgetDetailsView.swift†L984-L1003】【F:OffshoreBudgeting/Views/BudgetDetailsView.swift†L1348-L1357】 |
| `SettingsView` destructive alert | Global erase alert surfaces “Erase” (destructive) and “Cancel”; ensure new component respects role styling when placed inside alerts. 【F:OffshoreBudgeting/Views/SettingsView.swift†L32-L43】 |
| `ManageBudgetCardsSheet` / `ManageBudgetPresetsSheet` list rows | Rows currently rely on toggles; no text buttons embedded, so no migration needed inside list cells beyond toolbar actions noted above. |
| `CardDetailView` menu entries | Planned/variable expense menu entries rely on text buttons inside a `Menu`; ensure indicator hiding modifier remains compatible if the new text style injects different button styles. 【F:OffshoreBudgeting/Views/CardDetailView.swift†L436-L445】 |

These references cover every text-driven action surfaced through toolbars, menus, and dialogs today. When introducing the new text button, preserve any existing roles (`.destructive`, `.cancel`), keyboard shortcuts, fonts, and accessibility identifiers noted above so analytics and QA logging continue to match current expectations.
